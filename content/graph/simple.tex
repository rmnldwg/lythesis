\providecommand{\relativeRoot}{../..}
\documentclass[\relativeRoot/main.tex]{subfiles}
\graphicspath{
    {\subfix{./figures/}}
}


\begin{document}

\section{The simplest graphs}
\label{sec:graph:simple}

Before turning to the full problem where we want to find the best graph(s) connecting all clinically interesting \glspl{lnl} we have data on, let us consider a much simpler ``toy problem'': In this section we will only look at \glspl{lnl} II and III, which are the two most frequently involved levels.

\begin{figure}
    \centering
    \def\svgwidth{1.0\textwidth}
    \input{figures/simple_graphs.pdf_tex}
    \caption[
        Possible graphs for modelling unilateral spread in \glspl{lnl} II and II
    ]{
        All possible graphs that could represent the lymphatic flow from a primary tumor in the oropharynx to the \glspl{lnl} II and III, as well as among them.
        \begin{enumerate*}[label={(\arabic*)}]
            \item On the left, no correlations between the involvements of the two levels can be modelled.
            \item The next graph assumes the anatomically most sensible spread direction from \gls{lnl} II to III, while
            \item flips this connection.
            \item The rightmost graph allows for spread among \gls{lnl} II and III in both directions.
        \end{enumerate*}}
    \label{fig:graph:simple}
\end{figure}

Anatomically, \gls{lnl} II sits directly above \gls{lnl} III, so we would expect the direction of lymphatic spread to follow the pull of gravity and build the graph as displayed by the second graph from the left in \cref{fig:graph:simple}. However, we need to keep in mind that our model -- although anatomically motivated and designed to represent the mechanics of lymphatic spread -- is ultimately only capable of modelling correlations and does not necessarily allow us to draw conclusions about the causal relations. In other words, we need to be careful not to trust our abstract representation of the lymphatic network too much, as that might be misleading.

We can look back at \acrlongpl{bn}, as introduced in \cref{sec:previous_work:bayesian_network}. They represent factorizations of joint probability distributions of a number of \glspl{rv}. In our simplified case we want to find the factorizations of the joint which are all visualized in the three \glspl{dag} on the left of \cref{fig:graph:simple}:
%
\begin{equation}
    \Probofgiven{X_\text{II}, X_\text{III}}{T=1} = \begin{cases}
        \Probofgiven{X_\text{II}}{T=1} \Probofgiven{X_\text{III}}{T=1} \\
        \Probofgiven{X_\text{III}}{X_\text{II}, T=1} \Probofgiven{X_\text{II}}{T=1} \\
        \Probofgiven{X_\text{II}}{X_\text{III}, T=1} \Probofgiven{X_\text{III}}{T=1}
    \end{cases}
\end{equation}
%
The rightmost graph in \cref{fig:graph:simple} cannot represent a \gls{bn} and hence also no valid factorization, since it is not acyclic. In the \gls{hmm} model however, this is perfectly fine, since in that case different \glspl{rv} are connected across time-steps, which resolves the cycle.

\begin{table}
    \centering
    \begin{tabular}{|c|cc|}
        \hline
        Number & $X_\text{II}$ & $X_\text{III}$ \\
        \hline
        20 & 0 & 0 \\
        40 & 1 & 0 \\
         0 & 0 & 1 \\
        40 & 1 & 1 \\
        \hline
    \end{tabular}
    \caption{Mockup dataset $\boldsymbol{\mathcal{D}}$ for illustrating the ambiguity between the two possible spread directions from and two the \glspl{lnl} II and III.}
    \label{table:graph:simple:mockup}
\end{table}

Let $\boldsymbol{\mathcal{D}}$ now be a made-up dataset of 100 patients. Let us say 80 of those have metastases in \gls{lnl} II and of those 80 patients, 40 also harbor metastases in \gls{lnl} III. See also \cref{table:graph:simple:mockup} for how this data is supposed to look like. This constructed case is so simple that we can easily go through it in our heads: For the leftmost graph, this would lead to the maximum likelihood estimate of the spread probabilities from the tumor to the levels taking on the values $b_\text{II} = 80\%$ and $b_\text{III} = 40\%$. This would describe the prevalences of involvement for each level separately quite well, but it would also predict a probability of
%
\begin{equation}
    \begin{aligned}
        \Probofgiven{X_\text{II}=0, X_\text{III}=1}{T=1} &= \Probofgiven{X_\text{II}=0}{T=1} \Probofgiven{X_\text{III}=1}{T=1} \\
        &= \left( 1 - b_\text{II} \right) b_\text{III} = 8\%
    \end{aligned}
\end{equation}
%
but the corresponding pattern of involvement is never observed in the data.

Looking at the second graph from the left in \cref{fig:graph:simple}, the best estimate for the spread parameters would be $b_\text{II} = 80\%$, $b_\text{III} = 0\%$ and $t_{\text{II} \rightarrow \text{III}} = 50\%$. This describes the data perfectly: The probabilities of all four possible patterns of involvement exactly match the prevalence in the data.

Lastly, for the third graph, where we have the connection $\text{III} \rightarrow \text{II}$ instead of the other way around, the max. likelihood estimate for the respective spread parameters is $b_\text{III} = 40\%$, $b_\text{II} = 40\% / (1 - b_\text{III}) = 2/3$ and $t_{\text{III} \rightarrow \text{II}} = 100\%$. This third graph describes the data $\boldsymbol{\mathcal{D}}$ just as good as the second one, and we have no way of telling which is more or less likely to be the correct model.

Although this clearly is a constructed example, the illustrated ambiguity exists in real-world data and for the \gls{hmm} model as well. To show this, in the next section, we give the results of an experiment using real data on the involvement of \gls{opscc} patients from two different institutions.

\subsection{Comparisons}
\label{subsec:graph:simple:comp}

\input{_reproducibility.tex}

\begin{figure}
    \centering
    \def\svgwidth{1.0\textwidth}
    \input{figures/simple-prevalences.pdf_tex}
    \caption[
        Predicted prevalences of the models based on the simple graphs
    ]{
        Prevalences of involvement as histograms, predicted by the models based on the four different graphs (four rows respectively), computed for all possible involvement scenarios 
        (\begin{enumerate*}
            \item[(green)] all \glspl{lnl} are healthy,
            \item[(orange)] only \gls{lnl} II harbors metastases,
            \item[(blue)] vice versa, only \gls{lnl} II is metastatic and lastly,
            \item[(red)] both \glspl{lnl} are involved 
        \end{enumerate*})
        and early (left column), as well as late T-stage (right column). The corresponding data prevalence is plotted as a Beta posterior in the same color as the prediction. The legend in the top row shows how many patients of the respective T-stage showed the involvement of interest.
    }
    \label{fig:graph:simple:prevalenes}
\end{figure}

\end{document}
